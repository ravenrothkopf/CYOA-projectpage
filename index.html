<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <!-- Meta tags for social media banners, these should be filled in appropriatly as they are your "business card" -->
  <!-- Replace the content tag with appropriate information -->
  <meta name="description" content="DESCRIPTION META TAG">
  <meta property="og:title" content="SOCIAL MEDIA TITLE TAG"/>
  <meta property="og:description" content="SOCIAL MEDIA DESCRIPTION TAG TAG"/>
  <meta property="og:url" content="URL OF THE WEBSITE"/>
  <!-- Path to banner image, should be in the path listed below. Optimal dimenssions are 1200X630-->
  <meta property="og:image" content="static/image/your_banner_image.png" />
  <meta property="og:image:width" content="1200"/>
  <meta property="og:image:height" content="630"/>


  <meta name="twitter:title" content="TWITTER BANNER TITLE META TAG">
  <meta name="twitter:description" content="TWITTER BANNER DESCRIPTION META TAG">
  <!-- Path to banner image, should be in the path listed below. Optimal dimenssions are 1200X600-->
  <meta name="twitter:image" content="static/images/your_twitter_banner_image.png">
  <meta name="twitter:card" content="summary_large_image">
  <!-- Keywords for your paper to be indexed by-->
  <meta name="keywords" content="KEYWORDS SHOULD BE PLACED HERE">
  <meta name="viewport" content="width=device-width, initial-scale=1">


  <title>Procedural Adherence and Interpretability Through Neuro-Symbolic Generative Agents</title>
  <link rel="icon" type="image/x-icon" href="static/images/favicon.ico">
  <link href="https://fonts.googleapis.com/css?family=Google+Sans|Noto+Sans|Castoro"
  rel="stylesheet">

  <link rel="stylesheet" href="static/css/bulma.min.css">
  <link rel="stylesheet" href="static/css/bulma-carousel.min.css">
  <link rel="stylesheet" href="static/css/bulma-slider.min.css">
  <link rel="stylesheet" href="static/css/fontawesome.all.min.css">
  <link rel="stylesheet"
  href="https://cdn.jsdelivr.net/gh/jpswalsh/academicons@1/css/academicons.min.css">
  <link rel="stylesheet" href="static/css/index.css">

  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
  <script src="https://documentcloud.adobe.com/view-sdk/main.js"></script>
  <script defer src="static/js/fontawesome.all.min.js"></script>
  <script src="static/js/bulma-carousel.min.js"></script>
  <script src="static/js/bulma-slider.min.js"></script>
  <script src="static/js/index.js"></script>
</head>
<body>


  <section class="hero">
    <div class="hero-body">
      <div class="container is-max-desktop">
        <div class="columns is-centered">
          <div class="column has-text-centered">
            <h1 class="title is-1 publication-title">Procedural Adherence and Interpretability Through Neuro-Symbolic Generative Agents</h1>
            <div class="is-size-5 publication-authors">
              <!-- Paper authors -->
              <span class="author-block">
                <a href="https://ravenrothkopf.com/" target="_blank">Raven Rothkopf</a>,</span>
                <span class="author-block">
                  <a href="https://hannahz.me/" target="_blank">Hannah Tongxin Zeng</a>,</span>
                  <span class="author-block">
                    <a href="https://www.marksantolucito.com/" target="_blank">Mark Santolucito</a>
                  </span>
                  </div>

                  <div class="is-size-5 publication-authors">
                    <span class="author-block">Barnard College, Columbia University<br>2024</span>
                  </div>

                  <div class="column has-text-centered">
                    <div class="publication-links">
                         <!-- Arxiv PDF link -->
                      <span class="link-block">
                        <a href="https://arxiv.org/pdf/2402.16905" target="_blank"
                        class="external-link button is-normal is-rounded is-dark">
                        <span class="icon">
                          <i class="fas fa-file-pdf"></i>
                        </span>
                        <span>Paper</span>
                      </a>
                    </span>

                    <!-- Demo link -->
                    <span class="link-block">
                      <a href="https://barnard-pl-labs.github.io/CYOA-TSL/" target="_blank"
                      class="external-link button is-normal is-rounded is-dark">
                      <span class="icon">
                        <i class="fas fa-desktop"></i>
                      </span>
                      <span>Demo</span>
                    </a>
                  </span>

                  <!-- Github link -->
                  <span class="link-block">
                    <a href="https://github.com/Barnard-PL-Labs/CYOA-TSL" target="_blank"
                    class="external-link button is-normal is-rounded is-dark">
                    <span class="icon">
                      <i class="fab fa-github"></i>
                    </span>
                    <span>Code</span>
                  </a>
                </span>

                <!-- ArXiv abstract Link -->
                <span class="link-block">
                  <a href="https://arxiv.org/abs/2402.16905" target="_blank"
                  class="external-link button is-normal is-rounded is-dark">
                  <span class="icon">
                    <i class="ai ai-arxiv"></i>
                  </span>
                  <span>arXiv</span>
                </a>
              </span>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>


<!-- Teaser video-->
<!-- <section class="hero teaser">
  <div class="container is-max-desktop">
    <div class="hero-body">
      <video poster="" id="tree" autoplay controls muted loop height="100%">
        <source src="static/videos/banner_video.mp4"
        type="video/mp4">
      </video>
      <h2 class="subtitle has-text-centered">
        Aliquam vitae elit ullamcorper tellus egestas pellentesque. Ut lacus tellus, maximus vel lectus at, placerat pretium mi. Maecenas dignissim tincidunt vestibulum. Sed consequat hendrerit nisl ut maximus. 
      </h2>
    </div>
  </div>
</section> -->
<!-- End teaser video -->

<!-- Paper abstract -->
<section class="section hero is-light">
  <div class="container is-max-desktop">
    <div class="columns is-centered has-text-centered">
      <div class="column is-four-fifths">
        <h2 class="title is-3">Abstract</h2>
        <div class="content has-text-justified">
          <p>
            The surge in popularity of large language models (LLMs) has opened doors for new approaches to creating interactive agents. However, managing and interpreting the temporal behavior of such agents during a potentially infinite interaction remain challenging. The stateful, long-term horizon reasoning required for coherent agent behavior does not fit well into the LLM paradigm. We propose a combination of formal logic-based program synthesis and LLM content generation to bring guarantees of procedural adherence and interpretability to generative agent behavior. To illustrate the benefit of procedural adherence and interpretability, we use Temporal Stream Logic (TSL) to generate an automaton that enforces an interpretable, high-level temporal structure on an agent. With the automaton tracking long-term context and deciding to guide the conversation accordingly, we can drive content generation in a way that allows the LLM to focus on a shorter context window. We evaluated our approach on different tasks involved in creating an interactive agent specialized for generating choose-your-own-adventure games. We found that over all the tasks, an automaton-enhanced agent with procedural guarantees achieves at least 96% adherence to its temporal constraints, whereas a purely LLM-based agent demonstrates as low as 14.67% adherence.
          </p>
        </div>
      </div>
    </div>
  </div>
</section>
<!-- End paper abstract -->


<!-- Image carousel -->
<section class="hero is-small">
  <div class="hero-body">
    <div class="container">
       <div class="item">
        <img src="static/images/overview.jpg" alt="MY ALT TEXT"/>

        <h2 class="subtitle has-text">
          <span style="font-weight: bold;">Figure 1: </span> An example conversation between an end-user and a choose-your-own-adventure game agent. After receiving a user prompt, the LLM consults an internal automaton synthesized from the Temporal Stream Logic (TSL) specification in Fig. 2. Using previous story context, the automaton outputs a correct prompt modifier so that the agent's response aligns with its formal specification.
        </h2>
        <h2>In this paper, we combine LLMs with logic-based program synthesis techniques to build a framework for creating generative agents that are guaranteed to obey particular temporal properties. 
          In this system, developers provide a specification of the temporal behavior to which their agent should adhere, and we synthesize a system that structures LLM <span style="font-weight: bold;">queries</span> of the agent.
          <br>
          <br>
          The key design goal of our approach is an interactive generative agent with two main features:
          <br>
          <!--Indented list of features-->
          <ol style="margin-left: 20px;">
            <li><span style="font-weight: bold;">Adherence</span>: Despite explicit instructions in prompts, the LLM might still generate content that clearly violates the instructions. We want to make sure that the agent adheres to the provided specification.</li>
            <li><span style="font-weight: bold;">Interpretability</span>: When an LLM produces unexpected outcomes, it is difficult to pinpoint the cause from previous interactions and correct accordingly. The developer should be able to identify the root cause of decisions made by the agent.</li>
          </ol>
          <br>
          With these priorities, we turn to <span style="font-weight: bold;">reactive synthesis</span>.
          In reactive synthesis, we can use a description of an agent's long-horizon behavior to synthesize an automaton that gives instructions as a <span style="font-weight: bold;">prompt modifier</span> to the LLM of how to respond on each state transition.
          To decide how to transition between states, the automaton uses queries on the previous LLM output at each turn.
        </h2>
  </div>
</div>
</div>
</section>

<section class="hero is-small is-light">
  <div class="hero-body">
    <div class="container">
      <!-- Paper video. -->
      <h2 class="title is-3">Reactive Synthesis and Temporal Stream Logic</h2>
      <div class="is-centered">
        <span style="font-weight:bold">Temporal Stream Logic (TSL)</span> is one approach to specifying an agent's long-horizon behavior. 
        We can write properties about the temporal behavior of an agent, then synthesize an automaton that is guaranteed to meet those properties in program code. 
        <br><br>
        <!-- Two images next to each other horizontally -->
         <div class="columns is-centered">
        <div class="column is-half">
          <img src="static/images/tsl.jpeg" alt="MY ALT TEXT"/>
          <h2 class="subtitle has-text">
            <span style="font-weight: bold;">Figure 2: </span> A TSL specification for a choose-your-own-adventure game agent. The agent should ensure that the player visits a market before visiting a cave.
          </h2>
        </div>
        <div class="column is-half">
          <img src="static/images/automaton.jpeg" alt="MY ALT TEXT"/>
          <h2 class="subtitle has-text">
            <span style="font-weight: bold;">Figure 3: </span> An automaton synthesized from the TSL specification in Fig. 2. The automaton guides the agent's long-term content generation by providing prompt modifiers to the LLM.
          </h2>
        </div>
        </div>
        <br>
        For example, an agent specialized to generate text for interactive choose-your-own adventure games is depicted in Figure 1. 
        This particular agent uses an internal automaton from the TSL specification in Figure 2 to ensure the player visits a cave only after visiting a market.
        The automaton synthesized from this specification using reactive synthesis is also shown Figure 3.
      </div>
    </div>
  </div>
</section>

<section class="hero is-small">
  <div class="hero-body">
    <div class="container">
      <h2 class="title is-3">Procedural Adherence and Interpretablility</h2>
      <div class="is-centered">
      With this hybrid automaton-LLM system, we can treat an agent prompt and response as two different tasks: generating a correct response according to the prompt, which is controlled by the LLM, and choosing the correct prompt modifier that aligns with the agent's long-horizon behavior using the context of previous turns, which is controlled by the automaton. 
      <div class="container mt-4">
        <div class="alert alert-danger">
          <strong>Key Insight:</strong>
        This approach distinguishes between <span style="font-weight: bold;">point-in-time</span> adherence and interpretability (low-level agent behavior over one turn) vs. <span style="font-weight: bold;">procedural</span>  adherence and interpretability (high-level agent behavior over an entire conversation).
        </div>
        </div>
      </div>
      <div class="columns is-centered">
        <div class="column is-half">
          <img src="static/images/adherence.jpeg" alt="MY ALT TEXT"/>
        </div>
        <div class="column is-half">
          <img src="static/images/interpretability.jpeg" alt="MY ALT TEXT"/>
        </div>
      </div>
      Leveraging the correct-by-construction automaton, we get a generative agent with guaranteed procedural adherence and preexisting theories to achieve procedural interpretability for free. 
      We can use the automaton to track the long-term context of the conversation and decide how to guide the conversation accordingly. 
      This way, the LLM can focus on a shorter context window and the automaton can ensure that the agent adheres to its specified long-term behavior.
    </div>
    </div>
  </div>
</section>

<section class="hero is-small is-light">
  <div class="hero-body">
    <div class="container">
      <h2 class="title">CYOA Generative Agent Performance</h2>
      <h2>To demonstrate the benefits of procedural adherence, we tested how well a generative agent could adhere to four different long-term narrative constraints in the domain of choose-your-own-adventure games.
      We were able to obtain significantly better long-horizon results with our automaton-enhanced agent than state-of-the-art approaches that only rely on the GPT-4 LLM.
      </h2>
      <br>
      <h2>
      Our adherence measurements capture both procedural and point-in-time adherence for the automaton-enhanced agents, whereas we can only measure the point-in-time adherence of the pure-LLM agents. 
      We note that the automaton-enhanced agents all achieve 100% procedural adherence by construction, and the lack of point-in-time adherence leads to LLM hallucinations and specification violations.
      </h2>
      <br>
      <div class="columns is-centered">
        <img src="static/images/results.jpeg" alt="MY ALT TEXT" style="width: 50%;"/>
      </div>
      <div class="columns is-centered">
        <div class="column is-half">
            <div class="alert alert-danger">
              Across all games, the automaton-enhanced system achieved at least <span style="font-weight: bold;">96.00% adherence</span> to its temporal constraints.
            </div>
          </div>
        <div class="column is-half">
            <div class="alert alert-bad">
            Across all games, the pure-LLM system achieved as low as <span style="font-weight: bold;">14.67% adherence</span> to its temporal constraints.
            </div>
          </div>
        </div>
      </div>
      <h2>
      Our goal is to illustrate and evaluate one of many possible ways to guarantee procedural adherence and interpretability of an LLM. 
      We highlight the importance of the distinction between and separation of procedural and point-in-time properties when building neuro-symbolic generative agents. 
      </h2>
    </div>
  </div>
</section>
<!--End paper poster -->


<!--BibTex citation -->
  <section class="section" id="BibTeX">
    <div class="container is-max-desktop content">
      <h2 class="title">BibTeX</h2>
      <pre><code>@article{rothkopf2024procedurally,
        title={Procedural Adherence and Interpretability Through Neuro-Symbolic Generative Agents}, 
        author={Raven Rothkopf and Hannah Tongxin Zeng and Mark Santolucito},
        journal={arXiv preprint arXiv:2402.16905},
        year={2024},
        url={https://arxiv.org/abs/2402.16905}, 
  }</code></pre>
    </div>
</section>
<!--End BibTex citation -->


  <footer class="footer">
  <div class="container">
    <div class="columns is-centered">
      <div class="column is-8">
        <div class="content">

          <p>
            This page was built using the <a href="https://github.com/eliahuhorwitz/Academic-project-page-template" target="_blank">Academic Project Page Template</a>.
          </p>

        </div>
      </div>
    </div>
  </div>
</footer>

<!-- Statcounter tracking code -->
  
<!-- You can add a tracker to track page visits by creating an account at statcounter.com -->

    <!-- End of Statcounter Code -->

  </body>
  </html>
